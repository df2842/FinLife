# FinLife (Capital Quest)

A web-based financial life simulation game where players make decisions from age 16 to 67, experiencing real-world financial scenarios powered by AI.

## Overview

**Capital Quest** (formerly FinLife) is an interactive financial literacy game that simulates a person's financial journey through life. Players navigate job offers, major purchases, investments, and unexpected life events‚Äîall while managing their checking account balance and learning financial concepts.

## Features

- üéÆ **Life Simulation**: Progress from age 16 to retirement at 67
- ü§ñ **AI-Powered Scenarios**: Dynamic financial dilemmas generated by Google's Gemini AI
- üí∞ **Real Banking API**: Integrates with Capital One's Nessie API for transaction tracking
- üìä **Transaction History**: Complete log of all financial decisions
- ‚è≠Ô∏è **Fast Forward**: Jump to specific ages to see long-term impacts
- üé≠ **Animated Character**: Age-appropriate video avatars for different life stages
- üìà **Final Scorecard**: AI-generated financial persona and analysis at game end

## Tech Stack

### Backend
- **Python 3.x** with Flask
- **Google Generative AI (Gemini)** for scenario generation
- **Capital One Nessie API** for banking simulation
- **Flask-CORS** for cross-origin requests

### Frontend
- Vanilla JavaScript (ES6+)
- HTML5 with video elements
- CSS3 for styling

## Project Structure

```
FinLife/
‚îú‚îÄ‚îÄ app.py                 # Main Flask application & game logic
‚îú‚îÄ‚îÄ ai_agent.py           # AI scenario generation (MCQ, job offers, final summary)
‚îú‚îÄ‚îÄ api_client.py         # Capital One Nessie API client
‚îú‚îÄ‚îÄ Simulation.py         # Automated simulation runner & topic classifier
‚îú‚îÄ‚îÄ requirements.txt      # Python dependencies
‚îú‚îÄ‚îÄ index.html           # Game UI
‚îú‚îÄ‚îÄ script.js            # Frontend game controller
‚îú‚îÄ‚îÄ style.css            # Styling (not shown but referenced)
‚îú‚îÄ‚îÄ *.mp4                # Character animation videos (2.mp4-12.mp4)
‚îî‚îÄ‚îÄ logo_draft.png       # Game logo
```

## Setup Instructions

### 1. Prerequisites
- Python 3.7+
- Capital One Nessie API key ([Get one here](http://nessieisreal.com))
- Google Gemini API key ([Get one here](https://makersuite.google.com/app/apikey))

### 2. Installation

```bash
# Clone the repository
git clone https://github.com/df2842/FinLife.git
cd FinLife

# Install dependencies
pip install -r requirements.txt
```

### 3. Environment Configuration

Create a `.env` file in the project root:

```env
CAPITAL_ONE_API_KEY=your_nessie_api_key_here
GEMINI_API_KEY=your_gemini_api_key_here
```

### 4. Run the Application

```bash
# Start the Flask server
python app.py

# Server will run on http://localhost:5000
```

### 5. Open the Game

Open `index.html` in a web browser or serve it via a local web server:

```bash
# Option 1: Direct file open
# Just double-click index.html

# Option 2: Simple HTTP server
python -m http.server 8000
# Then navigate to http://localhost:8000
```

## API Endpoints

### Game Management
- `POST /game/start` - Initialize a new game session
- `POST /game/state` - Get current player state
- `POST /game/advance-year` - Progress to the next year
- `POST /game/fast-forward` - Jump to a target age
- `POST /game/history` - Retrieve transaction history

### Decision Handling
- `POST /decision/mcq` - Process multiple-choice scenario decision
- `POST /decision/job` - Process job offer decision

## Game Mechanics

### Age Progression
- **Start**: Age 16 with $10,000 starting balance
- **Adult Life** (18-66): Annual expenses automatically deducted based on quadratic formula
- **Retirement**: Age 67 triggers game over and final analysis

### Event Types

**Job Offers** (`event_type: "job"`)
- Triggered periodically based on age
- Income scales with age and career progression
- Connected to past life events

**Multiple-Choice Scenarios** (`event_type: "mcq"`)
- Key life events at ages 18 (college), 21 (car), 38 (house)
- Random financial dilemmas throughout life
- Three choices per scenario with varying financial impacts

### Financial System
- All transactions processed through Capital One Nessie API
- Balance updated after each decision
- Annual salary deposits (if employed)
- Age-based living expenses deductions

## Simulation & Analysis

The `Simulation.py` script enables automated gameplay for research purposes:

```bash
# Run 10 simulations (auto-detects mode)
python Simulation.py --runs 10

# Server mode (requires Flask app running)
python Simulation.py --runs 20 --mode server

# Offline mode (direct AI agent calls)
python Simulation.py --runs 15 --mode offline
```

**Topic Classification**: Scenarios are categorized into 8 financial literacy topics:
- Borrowing
- Saving
- Consuming
- Earning
- Go-to info sources
- Investing
- Insuring
- Comprehending risk

## AI Prompt Engineering

### Scenario Generation (`ai_agent.generate_mcq`)
- Context-aware: Uses player's age, balance, income, and life events
- Topic-focused: Can target specific life events (college, car, house)
- Structured output: Returns JSON with scenario title, description, and 3 choices

### Job Offers (`ai_agent.generate_jo`)
- Career progression logic
- Income scaling with age (max $500k)
- Connected to player's past decisions

### Final Summary (`ai_agent.generate_fs`)
- Analyzes complete transaction history
- Generates financial persona (e.g., "The Cautious Saver")
- Identifies best and worst financial decisions

## Configuration Constants

```python
PORT = 5000              # Flask server port
START_BALANCE = 10000    # Initial checking balance
START_AGE = 16          # Game start age
END_AGE = 67            # Retirement age
```

Expense formula (age 18+):
```python
annual_expenses = -45 * age¬≤ + 4000 * age - 30000
```

## Known Issues & Considerations

- Game sessions stored in memory (lost on server restart)
- No player authentication system
- API rate limits may affect rapid gameplay
- Videos must be in same directory as HTML file

## Future Enhancements

- Persistent database for game state
- Multiplayer/leaderboard features
- More sophisticated investment mechanics
- Loan and debt management systems
- Insurance and risk modeling
- Expanded AI scenario variety

## Credits

- **Banking API**: Capital One Nessie API
- **AI Generation**: Google Gemini (gemini-flash-latest)
- **Framework**: Flask, Flask-CORS

## License

All trademarks are the property of their respective owners. Any resemblance to real people or events is coincidental.

---

**Enjoy your financial journey!** üéÆüí∞
